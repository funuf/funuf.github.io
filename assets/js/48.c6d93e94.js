(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{491:function(s,a,t){"use strict";t.r(a);var e=t(23),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),t("h3",{attrs:{id:"docker-compose"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose"}},[s._v("#")]),s._v(" docker-compose")]),s._v(" "),t("p",[s._v("qcsd安装在nfs服务器上")]),s._v(" "),t("div",{staticClass:"language-yaml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3.1'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("jenkins")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jenkins"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("lts\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" jenkins\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" always\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发布端口")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 8080"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 基于JNLP的Jenkins代理通过tcp端口50000与Jenkins master进行通信")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 50000"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("50000")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("TZ")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Asia/Shanghai\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/jenkins_home \n")])])]),t("p",[s._v("安装过程会出现数据卷权限问题，用以下命令解决：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v(" /usr/local/docker/jenkins/data\n")])])]),t("h3",{attrs:{id:"k8s"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#k8s"}},[s._v("#")]),s._v(" k8s")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://mp.weixin.qq.com/s?__biz=MjM5MzU5NDYwNA==&mid=2247485698&idx=2&sn=5b2f74a8f0f1d9e383e34da2964e35a3&chksm=a695e48191e26d97d33573cea4cd9d2a1cef463785acd7c7b0ee889e4556839bf9ca5ffdd9f7&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[s._v("HostPath存储"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1559679",target:"_blank",rel:"noopener noreferrer"}},[s._v("NFS存储"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/jenkinsci/kubernetes-plugin",target:"_blank",rel:"noopener noreferrer"}},[s._v("Github"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[s._v("#")]),s._v(" 配置")]),s._v(" "),t("p",[s._v("为什么要配置，因为jenkins不是专门为Java开发的，其他语言也能使用。所以要配置java的相关环境。")]),s._v(" "),t("h3",{attrs:{id:"初始密码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始密码"}},[s._v("#")]),s._v(" 初始密码")]),s._v(" "),t("p",[s._v("在 "),t("code",[s._v("/var/jenkins_home/secrets/initialAdminPassword")]),s._v("文件内")]),s._v(" "),t("h3",{attrs:{id:"插件安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插件安装"}},[s._v("#")]),s._v(" 插件安装")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("安装推荐的插件")])]),s._v(" "),t("li",[s._v("选择插件来安装\n"),t("ul",[t("li",[s._v("Dashboard View")]),s._v(" "),t("li",[s._v("Publish over SSH")])])])]),s._v(" "),t("h3",{attrs:{id:"创建第一个管理员账户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建第一个管理员账户"}},[s._v("#")]),s._v(" 创建第一个管理员账户")]),s._v(" "),t("p",[s._v("用户名：root")]),s._v(" "),t("p",[s._v("密码：zmn2016")]),s._v(" "),t("p",[s._v("全名：qcsd")]),s._v(" "),t("p",[s._v("电子邮件地址：qcsd@qq.com")]),s._v(" "),t("h3",{attrs:{id:"实例配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实例配置"}},[s._v("#")]),s._v(" 实例配置")]),s._v(" "),t("p",[s._v("Jenkins URL 用于给各种Jenkins资源提供绝对路径链接的根地址。")]),s._v(" "),t("p",[s._v("使用默认值： http://192.168.3.130:8080/")]),s._v(" "),t("h3",{attrs:{id:"配置java"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置java"}},[s._v("#")]),s._v(" 配置Java")]),s._v(" "),t("ol",[t("li",[s._v("上传tar包到Jenkins的volume目录")]),s._v(" "),t("li",[s._v("解压")]),s._v(" "),t("li",[s._v("在Jenkins中配置JAVA_HOME")])]),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/config_java.png"}}),s._v(" "),t("h3",{attrs:{id:"配置maven"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置maven"}},[s._v("#")]),s._v(" 配置Maven")]),s._v(" "),t("ol",[t("li",[s._v("上传tar包到Jenkins的volume目录")]),s._v(" "),t("li",[s._v("解压")]),s._v(" "),t("li",[s._v("在Jenkins中配置MAVEN_HOME")])]),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/config_maven.png"}}),s._v(" "),t("h3",{attrs:{id:"配置maven-settings"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置maven-settings"}},[s._v("#")]),s._v(" 配置Maven Settings")]),s._v(" "),t("ol",[t("li",[s._v("将开发电脑的setting文件上传到Jenkins的volume的对应目录")]),s._v(" "),t("li",[s._v("在Jenkins中配置settings")]),s._v(" "),t("li",[s._v("为了避免每次都耗时下载jar包，该settings应配置"),t("code",[s._v("<localRepository>/var/jenkins_home/repo_maven</localRepository>")])]),s._v(" "),t("li",[s._v("可选（如果repo_maven目录没有权限，则应使用 "),t("code",[s._v("chmod 666 或 chmod 777对目标目录提权")]),s._v("）")]),s._v(" "),t("li",[t("strong",[s._v("为了构建镜像时的统一操作")]),s._v("，需要修改 "),t("code",[s._v("<output.directory.parent>/var/jenkins_home/jars</output.directory.parent>")])])]),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/config_maven_settings.png"}}),s._v(" "),t("h3",{attrs:{id:"配置remote-ssh-hosts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置remote-ssh-hosts"}},[s._v("#")]),s._v(" 配置remote ssh hosts")]),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/config_remote_ssh1.png"}}),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/config_remote_ssh2.png"}}),s._v(" "),t("h2",{attrs:{id:"管理凭据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理凭据"}},[s._v("#")]),s._v(" 管理凭据")]),s._v(" "),t("p",[s._v("无论是从仓库拉取代码，还是远程操作其他Linux，它们都需要进行用户认证，因此在Jenkins中提前添加一些凭据，供后续操作使用。")]),s._v(" "),t("p",[s._v("可以添加的凭证有5种：")]),s._v(" "),t("ol",[t("li",[s._v("Username with password：用户名和密码")]),s._v(" "),t("li",[s._v("SSH Username with private key： 使用SSH用户和密钥")]),s._v(" "),t("li",[s._v("Secret ﬁle：需要保密的文本文件，使用时Jenkins会将文件复制到一个临时目录中，再将文件路径设置到一个变量中，等构建结束后，所复制的Secret ﬁle就会被删除。")]),s._v(" "),t("li",[s._v("Secret text：需要保存的一个加密的文本串，如钉钉机器人或Github的api token")]),s._v(" "),t("li",[s._v("Certiﬁcate：通过上传证书文件的方式")])]),s._v(" "),t("h2",{attrs:{id:"创建-管理任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建-管理任务"}},[s._v("#")]),s._v(" 创建/管理任务")]),s._v(" "),t("ol",[t("li",[s._v("任务名后续不可修改")])]),s._v(" "),t("h3",{attrs:{id:"目录结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#目录结构"}},[s._v("#")]),s._v(" 目录结构")]),s._v(" "),t("div",{staticClass:"language-text extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("--volume（/usr/local/docker/jenkins/data）\n      |\n      |--apache-maven-3.5.4\n      |--jdk1.8.0_231\n      |--plugins\n      |--...\n      |--workspace\n            |    \n            |--Item1名称@tmp\n            |--Item1名称（eg：定时访问百度）\n                    |    \n                    |--pom.xml\n                    |--xxx-api    \n                    |--xxx-services\n                    |--doc\n                    |--docker\n            |--Item2名称    \n            |--Item3名称    \n            |--...    \n")])])]),t("h3",{attrs:{id:"构建jar包-执行shell"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建jar包-执行shell"}},[s._v("#")]),s._v(" 构建jar包：执行Shell")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"------------"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"'),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" wangdiantong-service\n/var/jenkins_home/apache-maven-3.5.4/bin/mvn -s /var/jenkins_home/apache-maven-3.5.4/conf/settings-codeup.xml clean package\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /var/jenkins_home/jars/wangdiantong.jar ./devops/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" devops\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("777")]),s._v(" build.sh\n")])])]),t("h3",{attrs:{id:"构建docker镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建docker镜像"}},[s._v("#")]),s._v(" 构建docker镜像")]),s._v(" "),t("h4",{attrs:{id:"构建脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建脚本"}},[s._v("#")]),s._v(" 构建脚本")]),s._v(" "),t("p",[s._v("下面是build.sh脚本")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#! /bin/sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Please note that you must run chomd +x")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ======================================================")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1. image_name由执行脚本时传递过来")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2. 注意服务器要定义ALIYUN_DOCKER_IMAGE_USER和ALIYUN_DOCKER_IMAGE_PASSWORD")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ======================================================")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#image_name=$1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("image_name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xxx\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALIYUN_DOCKER_IMAGE_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yyy\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALIYUN_DOCKER_IMAGE_PASSWORD")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zzz\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker-compose down")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" build -t "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${image_name}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login registry.cn-qingdao.aliyuncs.com/qcsd -u "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ALIYUN_DOCKER_IMAGE_USER}")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${ALIYUN_DOCKER_IMAGE_PASSWORD}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" tag "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${image_name}")]),s._v(" registry.cn-qingdao.aliyuncs.com/qcsd/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${image_name}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" push registry.cn-qingdao.aliyuncs.com/qcsd/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${image_name}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f ../${image_name}.yml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f ../${image_name}.yml")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker-compose up -d")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker-compose logs -f")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n")])])]),t("h4",{attrs:{id:"进行构建-ssh-publishers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#进行构建-ssh-publishers"}},[s._v("#")]),s._v(" 进行构建：SSH Publishers")]),s._v(" "),t("p",[s._v("因为jenkins容器内，没有安装docker。因此要执行jenkins宿主机的build脚本。")]),s._v(" "),t("p",[s._v("远程连接 3.130")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$WORKSPACE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" jenkins_workspace.txt\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOB_NAME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" jenkins_workspace.txt\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/docker/jenkins/data/workspace\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'aaa'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" a.txt\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JOB_NAME")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'bbb'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" b.txt\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" wangdiantong-service/devops\n./build.sh\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'构建完成'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ok.txt\n")])])]),t("h3",{attrs:{id:"运行容器-ssh-publishers"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行容器-ssh-publishers"}},[s._v("#")]),s._v(" 运行容器 ：SSH Publishers")]),s._v(" "),t("p",[s._v("远程连接 3.110")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/kubernetes/apps/\nkubectl delete -f wangdiantong.yml\nkubectl apply -f wangdiantong.yml\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])])]),t("h2",{attrs:{id:"触发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#触发"}},[s._v("#")]),s._v(" 触发")]),s._v(" "),t("h3",{attrs:{id:"远程仓库触发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#远程仓库触发"}},[s._v("#")]),s._v(" 远程仓库触发")]),s._v(" "),t("p",[s._v("在远程仓库，设置webhook，触发jenkins进行构建")]),s._v(" "),t("h3",{attrs:{id:"推送代码触发"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#推送代码触发"}},[s._v("#")]),s._v(" 推送代码触发")]),s._v(" "),t("p",[s._v("有时候，使用git远程仓库无法配置webhook触发jenkins：")]),s._v(" "),t("ol",[t("li",[s._v("远程仓库不支持，如 阿里云效的代码管理就没有配置webhook的地方")]),s._v(" "),t("li",[s._v("远程仓库在公网，jenkins在内网，且没有做内网穿透")])]),s._v(" "),t("p",[s._v("这时候可以选择jenkins的远程触发")]),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/trigger_api.png"}}),s._v(" "),t("p",[s._v("此时推送代码、触发构建可以使用git_push脚本一并完成：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'exec>>> [git push]'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'...'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'...'")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# https://blog.csdn.net/ABCisCOOL/article/details/109288845")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# read  -p "请输入提交信息Message: " message')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git add .")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# git commit -a -m "$message"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#curl http://192.168.3.130:8080/job/%E5%AE%9A%E6%97%B6%E8%AE%BF%E9%97%AE%E7%99%BE%E5%BA%A6/build?token=TOKEN_NAME")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://192.168.3.130:8080/job/%E5%AE%9A%E6%97%B6%E8%AE%BF%E9%97%AE%E7%99%BE%E5%BA%A6/build?token"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("wangdiantong\n")])])]),t("h3",{attrs:{id:"api触发构建的403"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api触发构建的403"}},[s._v("#")]),s._v(" api触发构建的403")]),s._v(" "),t("p",[s._v("Authentication required")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/4b4bdc3623d3",target:"_blank",rel:"noopener noreferrer"}},[s._v("参见这里"),t("OutboundLink")],1),s._v(" "),t("imgv",{attrs:{v:"/img/jenkins/trigger_api_403.png"}})],1),s._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.jenkins.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Jenkins--传送门"),t("OutboundLink")],1)])],1)}),[],!1,null,null,null);a.default=n.exports}}]);