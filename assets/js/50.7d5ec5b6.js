(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{490:function(s,t,a){"use strict";a.r(t);var e=a(23),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"网络配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络配置"}},[s._v("#")]),s._v(" 网络配置")]),s._v(" "),a("h3",{attrs:{id:"配置ip地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置ip地址"}},[s._v("#")]),s._v(" 配置IP地址")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 编辑文件 "/etc/sysconfig/network-scripts/ifcfg-(网卡名称)"，根据情况修改文件内容 ')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网络类型为以太网")]),s._v("\nTYPE "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" Ethernet\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 手动分配ip 地址 使用静态ip地址 取值 static（静态），dhcp（动态） none （不指定）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("static\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网卡设备名，设备名一定要跟文件名一致（linux 中设备也是一个文件）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("ens33\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 该网卡是否随网络服务启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ip地址 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.250\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 子网掩码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NETMASK")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".255.0\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网关")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".2.1\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# DNS （这里使用的是阿里的DNS）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DNS1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.5")]),s._v(".5.5\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DNS2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.6")]),s._v(".6.6\n")])])]),a("h3",{attrs:{id:"配置网络工作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置网络工作"}},[s._v("#")]),s._v(" 配置网络工作")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 编辑"/etc/sysconfig/network"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NETWORKING")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes\n")])])]),a("h3",{attrs:{id:"配置公共dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置公共dns"}},[s._v("#")]),s._v(" 配置公共DNS")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 编辑文件 "/etc/resolv.conf"，根据情况修改文件内容。')]),s._v("\nnameserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.5")]),s._v(".5.5\nnameserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("223.6")]),s._v(".6.6\n")])])]),a("h3",{attrs:{id:"重启网络服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启网络服务"}},[s._v("#")]),s._v(" 重启网络服务")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" network restart\n")])])]),a("h3",{attrs:{id:"关闭防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭防火墙"}},[s._v("#")]),s._v(" 关闭防火墙")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl status firewalld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# aciive（running）说明开启")]),s._v("\nsystemctl stop firewalld.service\nsystemctl status firewalld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# aciive（dead）说明关闭")]),s._v("\nsystemctl disable firewalld.service "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止防火墙服务器")]),s._v("\n")])])]),a("h2",{attrs:{id:"关闭交换空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭交换空间"}},[s._v("#")]),s._v(" 关闭交换空间")]),s._v(" "),a("h3",{attrs:{id:"关闭swap分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#关闭swap分区"}},[s._v("#")]),s._v(" 关闭swap分区")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("swapoff -a\n")])])]),a("h3",{attrs:{id:"永久关闭"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#永久关闭"}},[s._v("#")]),s._v(" 永久关闭")]),s._v(" "),a("p",[a("code",[s._v('echo "vm.swappiness = 0">> /etc/sysctl.conf')]),s._v(" （尽量不使用交换分区，注意不是禁用）")]),s._v(" "),a("p",[s._v("注释掉 "),a("code",[s._v("/etc/fstab")]),s._v(" 关于 swap 的配置")]),s._v(" "),a("h2",{attrs:{id:"校对时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#校对时间"}},[s._v("#")]),s._v(" 校对时间")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 编辑文件 "/etc/ntp.conf"，根据情况修改文件内容为：')]),s._v("\ndriftfile  /var/lib/ntp/drift\npidfile   /var/run/ntpd.pid\nlogfile /var/log/ntp.log\nrestrict    default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\nrestrict "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1\nserver "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.127")]),s._v(".1.0\nfudge  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.127")]),s._v(".1.0 stratum "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nserver ntp.aliyun.com iburst minpoll "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" maxpoll "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\nrestrict ntp.aliyun.com nomodify notrap nopeer noquery\n")])])]),a("p",[s._v("使用 ntpdate 的方式:")]),s._v(" "),a("ol",[a("li",[a("code",[s._v("yum install ntpdate")])]),s._v(" "),a("li",[a("code",[s._v("ntpdate ntp.aliyun.com")])]),s._v(" "),a("li",[a("code",[s._v("hwclock -w")]),s._v(" 写入硬件，避免重启失效")])]),s._v(" "),a("h2",{attrs:{id:"yum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yum"}},[s._v("#")]),s._v(" yum")]),s._v(" "),a("h3",{attrs:{id:"查看、卸载、安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看、卸载、安装"}},[s._v("#")]),s._v(" 查看、卸载、安装")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看已安装")]),s._v("\nyum list installed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" kube\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载")]),s._v("\nyum remove kubelet kubeadm kubectl\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" kubelet-1.18.2 kubeadm-1.18.2 kubectl -1.18.2\n")])])]),a("h3",{attrs:{id:"修改yum数据源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改yum数据源"}},[s._v("#")]),s._v(" 修改yum数据源")]),s._v(" "),a("ol",[a("li",[s._v("备份 "),a("code",[s._v("mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.backup")])]),s._v(" "),a("li",[s._v("下载新的 CentOS-Base.repo 到 "),a("code",[s._v("/etc/yum.repos.d/")])])]),s._v(" "),a("p",[s._v("注意：运行 yum makecache 生成缓存")]),s._v(" "),a("h4",{attrs:{id:"centos-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos-7"}},[s._v("#")]),s._v(" CentOS 7")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\n")])])]),a("h4",{attrs:{id:"centos-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos-8"}},[s._v("#")]),s._v(" CentOS 8")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-8.repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-8.repo\n")])])]),a("h2",{attrs:{id:"nfs网络存储"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nfs网络存储"}},[s._v("#")]),s._v(" NFS网络存储")]),s._v(" "),a("p",[s._v("基于网络实现对Linux目录进行挂载。")]),s._v(" "),a("h3",{attrs:{id:"nfs服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nfs服务器"}},[s._v("#")]),s._v(" NFS服务器")]),s._v(" "),a("h4",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("执行以下命令安装 nfs 服务器所需的软件包")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y nfs-utils\n")])])]),a("h4",{attrs:{id:"目录配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#目录配置"}},[s._v("#")]),s._v(" 目录配置")]),s._v(" "),a("p",[s._v("执行命令 vim /etc/exports，创建 exports 文件，文件内容如下：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("/usr/local/kubernetes/volumes *"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw,sync,no_subtree_check,no_root_squash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- /usr/local/kubernetes/volumes： 作为服务目录向客户端开放")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- *表示任何 IP 都可以访问")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- rw： 读写权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- sync： 同步权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- no_subtree_check： 表示如果输出目录是一个子目录，NFS 服务器不检查其父目录的权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#- no_root_squash： 客户端连接服务端时如果使用的是 root，那么也拥有对服务端分享的目录的 root 权限")]),s._v("\n")])])]),a("h4",{attrs:{id:"重启服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#重启服务"}},[s._v("#")]),s._v(" 重启服务")]),s._v(" "),a("p",[s._v("使配置生效")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("systemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" rpcbind\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nfs-server\n\nsystemctl start rpcbind\nsystemctl start nfs-server\nexportfs -r\n")])])]),a("h4",{attrs:{id:"检查配置是否生效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#检查配置是否生效"}},[s._v("#")]),s._v(" 检查配置是否生效")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("exportfs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出结果如下所示")]),s._v("\n/usr/local/kubernetes/volumes\n\t\t"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("world"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("h3",{attrs:{id:"nfs客户端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nfs客户端"}},[s._v("#")]),s._v(" NFS客户端")]),s._v(" "),a("h4",{attrs:{id:"安装-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("执行以下命令安装 nfs 客户端所需的软件包")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y nfs-utils\n")])])]),a("h4",{attrs:{id:"查看nfs服务端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看nfs服务端"}},[s._v("#")]),s._v(" 查看NFS服务端")]),s._v(" "),a("p",[s._v("执行以下命令检查 nfs 服务器端是否有设置共享目录")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# showmount -e $(nfs服务器的IP)")]),s._v("\nshowmount -e "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".216.82\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出结果如下所示")]),s._v("\nExport list "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.130:\n/usr/local/kubernetes/volumes *\n")])])]),a("h4",{attrs:{id:"进行挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#进行挂载"}},[s._v("#")]),s._v(" 进行挂载")]),s._v(" "),a("p",[s._v("执行挂载并且测试")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /usr/local/kubernetes/nfsmount\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount -t nfs $(nfs服务器的IP):/usr/local/kubernetes/volumes /usr/local/kubernetes/nfsmount")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mount device dir")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mount")]),s._v(" -t nfs "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.130:/usr/local/kubernetes/volumes /usr/local/kubernetes/nfsmount\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载完之后可以 df -h 查看")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".3.130:/usr/local/kubernetes/volumes   36G  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".2G   33G    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("% /usr/local/kubernetes/nfsmount\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 写入一个测试文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello nfs server"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /usr/local/kubernetes/nfsmount/test.txt\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 去往 nfs 服务器查看文件是否存在")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解除挂载")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# umount (挂载目录)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("umount")]),s._v(" /usr/local/kubernetes/nfsmount/\n")])])]),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.centoschina.cn/news",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS中文站--传送门"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=r.exports}}]);